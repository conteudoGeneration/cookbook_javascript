<h1>Primeiros passos com o NestJS</h1>

O **NestJS**, ou simplesmente Nest, √© um framework back-end para **NodeJS**, que auxilia no processo de desenvolvimento de aplica√ß√µes JavaScript/Typescript eficientes, escal√°veis e confi√°veis em cima do **Node.js**. O Nest utiliza como padr√£o a linguagem **TypeScript**, que possui uma sintaxe muito parecida com a do **Framework Angular**. Um detalhe importante sobre o Nest √© que ele utiliza em segundo plano o **Framework Node ExpressJS**. 

> **[Angular](https://angular.io/):** Plataforma de aplica√ß√µes web de c√≥digo-fonte aberto e front-end, baseado em TypeScript, liderado pela Equipe Angular do Google e por uma comunidade de indiv√≠duos e corpora√ß√µes. Angular √© uma reescrita completa do AngularJS, feito pela mesma equipe que o construiu.
>
> **[Express.js](https://expressjs.com/pt-br/):** Framework para Node.js, muito popular, que fornece os recursos m√≠nimos para constru√ß√£o de servidores web. Foi lan√ßado como software  livre e de c√≥digo aberto sob a Licen√ßa MIT. √â um dos mais populares  frameworks para servidores em Node.js

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="30px"/> <a href="https://nestjs.com/" target="_blank"><b>Site Oficial: NestJS</b></a></div>

<div align="left"><img src="https://i.imgur.com/izFuHID.png" title="source: imgur.com" width="30px"/> <a href="https://www.typescriptlang.org/pt/docs/" target="_blank"><b>Documenta√ß√£o: TypeScript</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript" target="_blank"><b>Documenta√ß√£o: JavaScript</b></a></div>

<div align="left"><img src="https://i.imgur.com/kpBWmL1.png" title="source: imgur.com" width="35px"/> <a href="https://nodejs.org/docs/latest-v16.x/api/index.html" target="_blank"><b>Documenta√ß√£o: NodeJS</b></a></div>

<br />

O grande diferencial do Nest em rela√ß√£o ao Express, est√° no n√≠vel de abstra√ß√£o bem acima das estruturas comuns do Node, al√©m de expor as suas API's diretamente √† pessoa desenvolvedora, garantindo a liberdade de usar uma infinidade de M√≥dulos de terceiros que est√£o dispon√≠veis para a plataforma, tornando poss√≠vel termos uma aplica√ß√£o rodando em produ√ß√£o rapidamente e com o esfor√ßo m√≠nimo de configura√ß√£o e implanta√ß√£o. 

> Na **programa√ß√£o**, a **abstra√ß√£o** sugere a distin√ß√£o que deve ser feita entre ‚Äúo que‚Äù o programa faz e ‚Äúcomo‚Äù ele √© implementado. Por exemplo, quando um M√©todo √© chamado, pode-se concentrar somente no que ele faz; apenas quando se est√° escrevendo o M√©todo √© que deve-se concentrar em como fazer.

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/" target="_blank"><b>Documenta√ß√£o do NestJS</b></a></div>

<br />

Para facilitar ainda mais a vida da pessoa desenvolvedora, o Nest disponibiliza o **Nest CLI**, uma ferramenta de linha de comando (pode ser executada dentro do prompt de comando do Windows, Power Shell, Git Bash e etc), que com apenas um comando simples voc√™ cria um projeto b√°sico do Nest. 

O **NestCLI** cria uma nova pasta com o nome do projeto, onde o reposit√≥rio local do Git j√° est√° inicializado (precisa apenas conectar com o seu reposit√≥rio remoto), o m√≥dulo AppModule (M√≥dulo principal da aplica√ß√£o) funcional, uma estrutura base para implementar as Classes do seu projeto, al√©m dos pacotes necess√°rios para iniciar a sua aplica√ß√£o. A cria√ß√£o de um novo projeto com a NestCLI √© recomendada especialmente para usu√°rios iniciantes. 

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/cli/overview" target="_blank"><b>Documenta√ß√£o do NestCLI</b></a></div>


<h2>1. NPM</h2>

O **NPM** (**Node Package Manager**) √© o Gerenciador de Pacotes do NodeJS, semelhante ao Maven e o Graddle do Java. O Gerenciador de Pacotes √© automaticamente instalado na sua m√°quina durante a instala√ß√£o do NodeJS e √© muito √∫til no Desenvolvimento de aplica√ß√µes JavaScript/TypeScript com o Node. Para interagir com o NPM, utilizamos o **NPM CLI**, uma ferramenta de linha de comando (pode ser executada dentro do prompt de comando do Windows, Power Shell, Git Bash e etc), que com alguns comandos simples √© poss√≠vel pesquisar, instalar, atualizar e remover pacotes do Node.  

<div align="left"><img src="https://i.imgur.com/N8NL9fx.png" title="source: imgur.com" width="40px"/><a href="https://www.npmjs.com/" target="_blank"><b> Site Oficial do NPM</b></a></div>

<div align="left"><img src="https://i.imgur.com/N8NL9fx.png" title="source: imgur.com" width="40px"/><a href="https://docs.npmjs.com/" target="_blank"><b>Documenta√ß√£o: NPM</b></a></div>

Por anos, o Node tem sido amplamente usado por pessoas desenvolvedoras para compartilhar ferramentas, instalar v√°rios m√≥dulos e gerenciar suas depend√™ncias JavaScript/TypeScript. Sabendo disso, √© realmente importante para pessoas que trabalham com Node.js entenderem minimamente o que √© o npm. 

Todas as ferramentas e bibliotecas utilizadas nos projetos NestJS est√£o dispon√≠veis no servidor do NPM, que funciona como um reposit√≥rio de pacotes Node. Este reposit√≥rio facilita e centraliza o download de todos os pacotes, independente de serem as oficiais do Node ou Desenvolvidos por outras empresas ou pessoas desenvolvedoras, dispensando a necessidade de procurar os pacotes no Google, por exemplo. Na imagem abaixo, vemos a p√°gina inicial do NPM:

<br />

<div align="center"><img src="https://i.imgur.com/8xAtyxQ.png?1" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ATEN√á√ÉO:** *O NPMCLI √© uma Ferramenta de Linha de comando (instalada pelo Node no seu computador), que ajuda a interagir com o Reposit√≥rio de Pacotes do NodeJS, hospedados no NPM.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

Outro ponto importante a ser destacado no NPM √© que um projeto Nest utiliza muitos pacotes, que gera alguns problemas no dia a dia, tais como: manter todos os pacotes atualizados, fazer o build e executar a sua aplica√ß√£o, realizar testes na aplica√ß√£o, entre outros. O **NPM** tamb√©m auxilia nestes processos do dia a dia, atrav√©s dos seus Scripts prontos que automatizam todas estas tarefas e simplificam o dia a dia da pessoa Desenvolvedora.

 <br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="100px"/> | <div align="left">**DICA:** *Al√©m do NPM, existe um outro Gerenciador de Pacotes para projetos Node chamado **Yarn**. Para saber mais, acesse: https://classic.yarnpkg.com/en/* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2>2. Como funciona um projeto NestJS?</h2>

1. O NestJS est√° organizado em M√≥dulos, ou seja, uma pasta que cont√©m todas as Classes necess√°rias para compor um Recurso (Postagem, Tema, Usuario, entre outros). Cada aplicativo tem pelo menos um M√≥dulo, o m√≥dulo raiz (App). O m√≥dulo raiz √© o ponto de partida que o Nest usa para construir o gr√°fico do aplicativo - a estrutura de dados interna que o Nest usa para resolver os relacionamentos e depend√™ncias do m√≥dulo e do provedor. 

   Embora aplicativos muito pequenos possam teoricamente ter apenas o m√≥dulo raiz, esse n√£o √© o caso t√≠pico. Queremos enfatizar que os m√≥dulos s√£o fortemente recomendados como uma forma eficaz de organizar seus componentes. Assim, para a maioria dos aplicativos, a arquitetura resultante empregar√° v√°rios m√≥dulos, cada um encapsulando um conjunto de recursos intimamente relacionado.

   <h3>Arquitetura B√°sica do NestJS</h3>

   <div align="center"><img src="https://i.imgur.com/uetwYxV.jpg" title="source: imgur.com" /></div>

   Observe que a imagem acima representa um Recurso, logo, cada Recurso da aplica√ß√£o √© um M√≥dulo do Nest. Cada M√≥dulo √© composto minimamente por:

   | Classe         | Descri√ß√£o                                                    |
   | -------------- | ------------------------------------------------------------ |
   | **Module**     | Um m√≥dulo √© uma classe anotada com um decorador @Module(). O decorador @Module() fornece metadados que o Nest usa para organizar a estrutura do aplicativo. Nesta Classe s√£o registradas todas as Classes abaixo. Todos os M√≥dulos s√£o Registrados em AppModule (M√≥dulo principal) |
   | **Entity**     | Camada respons√°vel pela abstra√ß√£o de nossos objetos e tabelas em nossos Bancos de dados, ou seja, cria as Tabelas no Banco de dados. |
   | **Repository** | Interface respons√°vel pela comunica√ß√£o direta com o banco de dados. Ela pode ser utilizada atrav√©s de uma simples Inje√ß√£o de Depend√™ncia, ou  criando uma Classe customizada que herda a Interface Repository. |
   | **Controller** | Camada respons√°vel por manipular todas as requisi√ß√µes feitas do lado de fora da nossa API. Essas requisi√ß√µes s√£o realizadas atrav√©s de URL's utilizando o protocolo HTTP. |
   | **Service**    | Camada respons√°vel por toda regra de neg√≥cio e tratativa de dados, sempre seguindo o modelo de neg√≥cio da aplica√ß√£o. |

   Observe que essa estrutura segue os princ√≠pios da **Arquitetura Hexagonal**. A aplica√ß√£o fica isolada dentro da API, utiliza as Classes Controladoras para interagir com o Usu√°rio e mais a frente voc√™ ver√° que utilizaremos a Interface Repository para interagir com o Banco de dados. Uma vez em Produ√ß√£o, esta aplica√ß√£o poder√° interagir com qualquer front-end, back-end ou app mobile.

   <br />


<h3>2.1 Como planejar um projeto NestJS?</h3>

Quais M√≥dulos nossa aplica√ß√£o precisar√° para solucionar o problema que a aplica√ß√£o se prop√µe?

Quais endpoints vamos oferecer? 

> Um endpoint √© um caminho (/postagens por exemplo), que associado a um m√©todo do protocolo HTTP (GET, POST, PUT, DELETE), gera uma a√ß√£o em nossa aplica√ß√£o.

Em geral, temos pelo menos um endpoint para cada m√©todo HTTP (podemos ter mais de um desde que os caminhos sejam diferentes), em cada M√≥dulo do nosso modelo de neg√≥cios. Veja abaixo um exemplo:

**M√≥dulo:** **Postagem**

- Endpoint para recuperar todos os dados de uma postagem (GET) 
- Endpoint para inserir uma nova postagem (POST)
- Endpoint para atualizar dados de uma postagem (PUT)
- Endpoint para remover uma postagem (DELETE)

Como estes endpoints estar√£o estruturados no nosso sistema? 

Vamos discutir isto mais adiante...

<h1>Projeto 01 - Hello World!</h1>

<h2>üë£ Passo 01 - Instalando o Nest</h2>

Para desenvolver os nossos projetos Nest utilizaremos o **Visual Studio Code (VSCode)**. Para executarmos os Projetos Nest vamos precisar tamb√©m do **Node** instalado no computador.

<br />

<div align="left"><img src="https://i.imgur.com/sOdL7HU.png" title="source: imgur.com" width="30px"/> <a href="https://code.visualstudio.com/download" target="_blank"><b>Site Oficial: VSCode</b></a></div>

<div align="left"><img src="https://i.imgur.com/kpBWmL1.png" title="source: imgur.com" width="30px"/> <a href="https://nodejs.org/en/" target="_blank"><b>Site Oficial: NodeJS</b></a></div>

<br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="150px"/> | <div align="left"> **DICA:** *Caso voc√™ tenha alguma d√∫vida quanto a instala√ß√£o do VSCode, consulte o <a href="../00_ambiente/06_install_vscode.md" >Guia de Instala√ß√£o do VSCode </a>. Caso voc√™ tenha alguma d√∫vida quanto a instala√ß√£o do Node, consulte o <a href="../00_ambiente/07_install_node.md" >Guia de Instala√ß√£o do Node </a>.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

1. Crie uma pasta na **√Årea de Trabalho** do Windows chamada **nestjs**
1. Abra o VSCode

<div align="center"><img src="https://i.imgur.com/AtTA7K4.png" title="source: imgur.com" /></div>

3. No VSCode, abra a pasta **nestjs** atrav√©s do menu **File ü°™ Open Folder...**

<div align="center"><img src="https://i.imgur.com/TgvVW26.png" title="source: imgur.com" /></div>

4. Depois de abrir a pasta, abra o **Terminal** do VSCode atrav√©s do menu **Terminal ü°™ New Terminal**

<div align="center"><img src="https://i.imgur.com/4rdobXK.png?1" title="source: imgur.com" /></div>

5. Ser√° aberta a tela do **Power Shell** na parte inferior da janela do VSCode.

<div><img src="https://i.imgur.com/UAgppG0.png" title="source: imgur.com" /></div>

6. Antes de come√ßarmos a instala√ß√£o do Nest, vamos checar se o Node est√° instalado corretamente atrav√©s do comando abaixo:

```bash
node -v
```
<div><img src="https://i.imgur.com/boUzHVu.png" title="source: imgur.com" /></div>

7. Verifique tamb√©m se o **NPM** est√° instalado atrav√©s do comando:

```bash
npm -v
```

<div><img src="https://i.imgur.com/UvLH8lY.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:** No momento em que este material foi escrito, a vers√£o LTS mais atual do Node era a vers√£o 16.15.1 LTS. Ao utilizar este material no futuro, pode ser que a vers√£o mais atual seja outra* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ATEN√á√ÉO:** *Ao executar os comandos do NPM no PowerShell, caso apare√ßa a mensagem de erro: Cannot be loaded because running scripts is disabled on this system, <a href="config_vscode_nest.md">clique aqui</a> e veja como corrigir. * </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

8. Para instalar o **Nest**, digite o comando abaixo

```bash
npm i -g @nestjs/cli
```
9. Ao concluir a instala√ß√£o ser√° exibida a mensagem abaixo:

<div align="center"><img src="https://i.imgur.com/Eg3un4k.png" title="source: imgur.com" /></div>

8. Verifique se o **Nest** est√° instalado atrav√©s do comando:

```bash
nest -v
```

<div align="center"><img src="https://i.imgur.com/bf1Rtp2.png" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:** No momento em que este material foi escrito, a vers√£o mais atual do NestJS era a vers√£o 8.2.8.  Ao utilizar este material no futuro, pode ser que a vers√£o mais atual seja outra* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h2>üë£ Passo 02 - Criando o Projeto com o NestCLI</h2>

1. Ainda no Terminal, digite o comando ***nest new <nome do projeto>***, onde <nome do projeto> √© o nome do seu projeto. No nosso exemplo, **hello-world**. 

```bash
nest new hello-world
```

2. O **NestCLI** criar√° a estrutura de pastas, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/F9KOn9x.png" title="source: imgur.com" /></div>

3. Na sequ√™ncia, perguntar√° **Qual o Gerenciador de Pacotes que voc√™ deseja utilizar?** Selecione o **npm** e pressione tecla **enter** do seu teclado (Terminal n√£o utiliza mouse).

<div align="center"><img src="https://i.imgur.com/uvo9mbB.png" title="source: imgur.com" /></div>

4. Ao finalizar a cria√ß√£o do projeto, ser√° exibida a mensagem abaixo:

<div align="center"><img src="https://i.imgur.com/kBaMsMx.png" title="source: imgur.com" /></div>

5. O Projeto hello-world est√° criado!

<h2>üë£ Passo 03 - Conhecendo o Projeto Nest</h2>

A estrutura do pastas do nosso projeto Nest (hello-world) Ô¨Åcar√° semelhante a imagem abaixo:

 <div align="center"><img src="https://i.imgur.com/Y1XQRTK.png" title="source: imgur.com" /></div>

<h3>3.1 Entendendo a Estrutura do nosso projeto</h3>

| Item                    | Descri√ß√£o                                                    |
| ----------------------- | ------------------------------------------------------------ |
| **node_modules**        | Nesta pasta o NPM salva todos os pacotes necess√°rios para a aplica√ß√£o funcionar. Falaremos mais a frente sobre o NPM. |
| **src**                 | Esta √© a pasta mais importante da aplica√ß√£o, onde ser√° desenvolvido todo o c√≥digo da API Nest. <br />Dentro desta pasta existem 4 Classes que formam o M√≥dulo principal da aplica√ß√£o (**app**), al√©m da Classe **main.ts**, que √© respons√°vel por inicializar a aplica√ß√£o. <br /> **N√£o apague a Classe main.ts e a Classe AppModule sobre hip√≥tese alguma**. |
| **test**                | Nesta pasta ser√£o desenvolvidas as Classes de Teste da aplica√ß√£o. |
| **.eslintrc.js**        | Configura√ß√µes do pacote Eslint. Este pacote √© respons√°vel pelo processo de aplicar regras (boas pr√°ticas) no  c√≥digo TypeScript e destacar padr√µes incorretos ou c√≥digos problem√°ticos que n√£o aderem a determinadas diretrizes de estilo. Exemplo: c√≥digo com recuo (identa√ß√£o) de 4 espa√ßos em branco ao inv√©s de 2. |
| **nest-cli.json**       | Arquivo de configura√ß√£o do NestCLI. Falaremos mais a frente sobre o NestCLI. |
| **package.json**        | Este arquivo armazena todas as configura√ß√µes necess√°rias para o projeto NestJS funcionar, ou seja, a lista de pacotes e as configura√ß√µes do projeto. |
| **package-lock.json**   | Este arquivo √© gerado automaticamente para qualquer opera√ß√£o em que o npm modifique a pasta  `node_modules` ou o arquivo `package.json`. Ele descreve a √°rvore (estrutura de pacotes e suas configura√ß√µes), exata que foi gerada pelo NPM, de modo que as instala√ß√µes subsequentes possam gerar √°rvores id√™nticas, independentemente das atualiza√ß√µes de depend√™ncias intermedi√°rias. |
| **tsconfig.json**       | O arquivo tsconfig.json em uma pasta indica que ela √© a pasta raiz de um projeto TypeScript. O arquivo tsconfig.json especifica os arquivos da pasta raiz e as op√ß√µes que o compilador precisar√°  para compilar o projeto que utiliza a linguagem TypeScript. |
| **tsconfig.build.json** | O arquivo tsconfig.build.json tem a mesma fun√ß√£o do arquivo tsconfig.json, entretanto ele √© voltado para o Build do projeto, ou seja, a vers√£o finalizada do projeto, pronta para produ√ß√£o. |

<br />

<div align="left"><img src="https://i.imgur.com/N8NL9fx.png" title="source: imgur.com" width="30px"/> <a href="https://docs.npmjs.com/cli/v7/configuring-npm/package-json" target="_blank"><b>Documenta√ß√£o: package.json</b></a></div>

<div align="left"><img src="https://i.imgur.com/N8NL9fx.png" title="source: imgur.com" width="30px"/> <a href="https://docs.npmjs.com/cli/v7/configuring-npm/package-lock-json" target="_blank"><b>Documenta√ß√£o: package-lock.json</b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="30px"/> <a href="https://docs.nestjs.com/cli/overview" target="_blank"><b>Documenta√ß√£o: NestCLI</b></a></div>

<div align="left"><img src="https://i.imgur.com/izFuHID.png" title="source: imgur.com" width="30px"/> <a href="https://www.typescriptlang.org/pt/docs/handbook/tsconfig-json.html" target="_blank"><b>Documenta√ß√£o: tsconfig</b></a></div>

<br />

<h2>üë£ Passo 04 - Conhecendo o M√≥dulo app</h2>

Dentro da pasta **src**, temos alguns arquivos TypeScript que s√£o respons√°veis por inicializar o nosso projeto. Estas classes s√£o geradas automaticamente pelo Nest durante a cria√ß√£o do projeto e juntas formam o M√≥dulo app da aplica√ß√£o (M√≥dulo Principal). Vamos conhecer estas Classes:

<div align="center"><img src="https://i.imgur.com/6dQ1AP4.png" title="source: imgur.com" /></div>

| Classe                     | Descri√ß√£o                                                    |
| -------------------------- | ------------------------------------------------------------ |
| **main.ts**                | Classe principal da aplica√ß√£o. Usando o m√©todo *NestFactory.create()* , uma nova inst√¢ncia do aplicativo Nest √© criada. |
| **app.module.ts**          | Cont√©m a implementa√ß√£o do m√≥dulo raiz do aplicativo.         |
| **app.controller.ts**      | Cont√©m a implementa√ß√£o de um controlador b√°sico com apenas uma rota (/). |
| **app.service.ts**         | Cont√©m a implementa√ß√£o de um servi√ßo b√°sico.                 |
| **app.controller.spec.ts** | Cont√©m a implementa√ß√£o de um teste b√°sico para o controlador. |

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes! Observe o padr√£o de nomes das Classes. Ao criar novas Classes em um projeto Nest. Este padr√£o deve ser respeitado <recurso>.<tipo_da_classe>.ts.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/first-steps#platform" target="_blank"><b>Documenta√ß√£o: <i>Estrutura do Projeto NestJS</i></b></a></div>


Vamos olhar o c√≥digo das Classes **main, app.module, app.service e app.controller**.

<h3>4.1. Classe Main</h3>

<div align="center"><img src="https://i.imgur.com/Cq41Vi4.png" title="source: imgur.com" /></div>

**Linha 1:** **NestFactory** √© importada da biblioteca *@nestjs/core* . 

**Linha 2:** O M√≥dulo **AppModule** foi importado do arquivo *app.module.ts* (M√≥dulo principal da aplica√ß√£o) do projeto.

**Linha 4:** A fun√ß√£o ass√≠ncrona (async) **bootstrap** √© inicializada. 

**Linha 5:** O m√©todo **NestFactory.create()** cria uma nova inst√¢ncia do aplicativo Nest com a partir do M√≥duloPrincipal da aplica√ß√£o. 

**Linha 6:** Para iniciar o servidor, o pr√≥ximo passo √© chamar o m√©todo **listen** e informar a porta na qual o servidor WEB vai utilizar, por exemplo, **porta 3000**. Como o m√©todo listen est√° retornando uma Promisse (promessa), que o servidor ser√° iniciado com sucesso, usamos a palavra-chave await para pausar a execu√ß√£o da fun√ß√£o e esperar que a promisse seja resolvida.

**Linha 8:** A Classe √© finalizada com a chamada da fun√ß√£o **bootstrap()**, para que o c√≥digo seja executado.

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/first-steps#platform" target="_blank"><b>Documenta√ß√£o: <i>Classe Main</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/Marcelo7211/-nest-hello-world/blob/main/src/main.ts" target="_blank"><b>C√≥digo fonte da Classe Main</b></a></div>


<br />

<h3>4.2. Classe AppService</h3>

<div align="center"><img src="https://i.imgur.com/RilsjvN.png" title="source: imgur.com" /></div>

**Linha 1:** O Decorator **@Injectable** foi importado do pacote **@nestjs/common** .

> **Decorator:** √â um tipo especial de declara√ß√£o que pode ser anexada na assinatura de uma Classe, um M√©todo, um Atributo ou um Par√¢metro. Decorators usam a forma @expression, onde express√£o deve resultar em uma fun√ß√£o que ser√° chamada em tempo de execu√ß√£o com informa√ß√µes sobre a declara√ß√£o decorada. **Exemplo:** @Injectable indica que a Classe √© uma Classe de Servi√ßo, que pode ser injetada em outras Classes (veremos este assunto mais adiante).

**Linha 3:** Para tornar **AppService** uma classe de Servi√ßo (Provider), o decorator **@Injectable** foi adicionado antes da assinatura da Classe. Observe que a assinatura da Classe foi iniciada com o comando **export**. Este comando torna a Classe de Servi√ßo vis√≠vel ("injet√°vel") em qualquer Controladora da aplica√ß√£o.

> **Provider:** Provedor √© uma Classe que pode ser **injetada** como uma depend√™ncia; isso significa que os Objetos podem criar v√°rios relacionamentos uns com os outros, e esta fun√ß√£o de relacionar as inst√¢ncias dos Objetos pode ser amplamente delegada ao Nest.

**Linha 5:** Foi criado o M√©todo **getHello()**. Este m√©todo est√° apenas retornando a string est√°tica ‚ÄúHello World!‚Äù. Em um cen√°rio do mundo real, um m√©todo de servi√ßo poderia ser usado para recuperar dados, por exemplo, de um Banco de dados, um servi√ßo da Web ou alguma outra fonte de dados.

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documenta√ß√£o: <i>Providers - Service</i></b></a></div>


<div align="left"><img src="https://i.imgur.com/izFuHID.png" title="source: imgur.com" width="30px"/> <a href="https://www.typescriptlang.org/docs/handbook/decorators.html" target="_blank"><b>Documenta√ß√£o: Decorators</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/Marcelo7211/-nest-hello-world/blob/main/src/app.service.ts" target="_blank"><b>C√≥digo fonte da Classe AppService</b></a>

<br />

<h3>4.3. Classe AppController</h3>

<div align="center"><img src="https://i.imgur.com/cAUEx9R.png" title="source: imgur.com" /></div>

**Linha 1:** Os decorators **@Controller** e **@Get** foram importados do pacote **@nestjs/common** .

**Linha 2:** A Classe **AppService** foi importada do arquivo **app.service.ts** (Service principal da aplica√ß√£o) do projeto.

**Linha 4:** Para tornar **AppController** uma Classe Controladora (Controller), adicionamos o decorator **@Controller**  na assinatura da Classe. 

**Linha 6:** Uma Classe Controladora depende de uma Classe de Servi√ßo, em nosso exemplo, a Classe Controladora  **AppController** usa Classe de Servi√ßo **AppService**, e por isso a instru√ß√£o de importa√ß√£o da **AppService** foi adicionada na linha 2. Ao usar o conceito de **Inje√ß√£o de Depend√™ncia**, o **AppService** √© inserido na **AppController** (adicionando um par√¢metro Construtor do tipo AppService).

 > **Inje√ß√£o de depend√™ncia:** √â um tipo de **invers√£o de controle** (ou *Inversion of Control* ‚Äì IoC), que d√° nome ao processo de criar inst√¢ncias das Classes (pode ser mais de uma), que um Objeto precisa para funcionar, transferindo essa responsabilidade da pessoa desenvolvedora, para o sistema. Gra√ßas √† este conceito n√£o precisamos criar M√©todos Construtores de forma explicita nas nossas Classes e criar/instanciar Objetos de forma manual.

**Linha 8:** Para declarar que este m√©todo trata uma Requisi√ß√£o **HTTP GET**, o decorator **@Get** foi adicionado no M√©todo **getHello()**. Como o decorator **@Get** n√£o possui nenhum par√¢metro, o m√©todo getHello() responder√° a todas as requisi√ß√µes do tipo **HTTP GET**, enviadas no endere√ßo: http://localhost:3000/ (index)

Relembrando o modelo de uma Requisi√ß√£o HTTP:

- **Servidor:** Endere√ßo do servidor local, ou seja, o seu computador (http://localhost:3000). A porta 3000 foi definida na Classe Main.
- **URL:** Endere√ßo da requisi√ß√£o (/)
- **Verbo:** Define qual m√©todo HTTP ser√° acionado na Classe controladora (GET).
- **Corpo da requisi√ß√£o (Request Body):** Objeto que cont√©m os dados que ser√£o criados ou atualizados (GET n√£o possui corpo da requisi√ß√£o).

Linha 10:  O M√©todo **getHello** da Classe Controladora **AppController** est√° usando o M√©todo **getHello()** da Classe de Servi√ßo **AppService** para recuperar os dados e, ao mesmo tempo, retornar esses dados como Resposta (a string Hello World!).

Ap√≥s receber e processar a requisi√ß√£o, a Classe Controladora Responder√° com:

- Um **C√≥digo de Status HTTP** pertinente a opera√ß√£o que est√° sendo realizada (neste exemplo **200 ü°™ OK** )
- O resultado do processamento (Dados de uma consulta, por exemplo) inserido diretamente no Corpo da resposta (**Response Body**)

<br />

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="25px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Methods" target="_blank"><b>Documenta√ß√£o: HTTP Methods Request</b></a></div>

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="25px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Status" target="_blank"><b>Documenta√ß√£o: HTTP Status Code</b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.spring.io/spring-framework/docs/5.0.13.RELEASE/spring-framework-reference/web.html#mvc-ann-controller" target="_blank"><b>Documenta√ß√£o: <i>Controller</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/controllers#routing" target="_blank"><b>Documenta√ß√£o: <i>Routing - Http Methods</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/Marcelo7211/-nest-hello-world/blob/main/src/app.controller.ts" target="_blank"><b>C√≥digo fonte da Classe AppController</b></a></div>

<br />

<h3>4.4. Classe AppModule</h3>

<div align="center"><img src="https://i.imgur.com/oTXyujQ.png" title="source: imgur.com" /></div>

**Linha 1:** O decorator **@Module** foi importado do pacote **@nestjs/common** .

**Linha 2:** A Classe **AppController** foi importada do arquivo **app.controller.ts** (Classe Controladora principal da aplica√ß√£o) do projeto.

**Linha 3:** A Classe **AppService** foi importada do arquivo **app.service.ts** (Classe de Servi√ßo principal da aplica√ß√£o) do projeto.

**Linha 5:** Para declarar a classe **AppModule** como um M√≥dulo, adicionamos o decorator **@Module**, al√©m de um objeto com tr√™s propriedades:

- imports (Importa√ß√µes)
- controllers (Classes Controladoras)
- providers (Provedores - Classes de Servi√ßo)

**Linha 6:** A propriedade **imports** √© uma lista opcional de M√≥dulos importados, que exportam os Provedores (Servi√ßos), que s√£o necess√°rios no M√≥dulo.

**Linha 7:** A propriedade **controllers** registra todas as Classes Controladoras que devem fazer parte do M√≥dulo (**AppModule**) no array que √© atribu√≠do √† propriedade **controllers** (no estado inicial da aplica√ß√£o existe apenas uma Classe Controladora registrada: **AppController** ).

**Linha 8:** A propriedade **providers** registra todas as Classes de Servi√ßo que devem estar dispon√≠veis no M√≥dulo (**AppModule**) no array que √© atribu√≠do √† propriedade **providers** (no estado inicial da aplica√ß√£o existe apenas uma Classe de Servi√ßo registrada: **AppService** ).

**Linha 10:** **export class AppModule {}** Torna o M√≥dulo vis√≠vel (import√°vel) em qualquer parte da aplica√ß√£o.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes! Todos os M√≥dulos que forem constru√≠dos dentro do Nest sempre ter√£o essa estrutura como base: Classe de Servi√ßo, Classe Controladora e ambas registradas no M√≥dulo.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/modules" target="_blank"><b>Documenta√ß√£o: <i>Modules</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/Marcelo7211/-nest-hello-world/blob/main/src/app.module.ts" target="_blank"><b>C√≥digo fonte da Classe AppModule</b></a></div>

<br />

Agora, que temos uma primeira impress√£o dos blocos de constru√ß√£o mais importantes do aplicativo Nest padr√£o, estamos prontos para iniciar o servidor e ver o que estamos obtendo como Resposta da nossa Requisi√ß√£o.

<h2>üë£ Passo 05 - Executar o Projeto</h2>

1. De volta ao Terminal, acesse a pasta do projeto (hello-world) atrav√©s do comando abaixo:

```bash
cd hello-world
```

2. Verifique se voc√™ est√° dentro da pasta do projeto, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/Z05eS9Y.png" title="source: imgur.com" /></div>

3. Digite o comando ***npm run start:dev***, para compilar e executar o nosso projeto **hello-world**. 

```bash
npm run start:dev
```

4. Neste momento o Nest em conjunto com o Node varre todo o seu projeto procurando por **TODAS** as Classes  e checar√° se o c√≥digo est√° correto ou se falta algum pacote. Observe que o endpoint para o M√©todo getHello() tamb√©m foi mapeado, como indicado na imagem abaixo em amarelo:

<div align="center"><img src="https://i.imgur.com/opB6yfE.png" title="source: imgur.com" /></div>

5. Para finalizar a execu√ß√£o do projeto, utilize as teclas **Ctrl + C** do teclado. Ap√≥s pressionar estas teclas, ser√° exibida a mensagem abaixo perguntando se voc√™ deseja finalizar a aplica√ß√£o.

<div align="center"><img src="https://i.imgur.com/0s6Giqz.png?1" title="source: imgur.com" /></div>

6. Digite **S** para finalizar ou **N** para continuar.

O Nest possui outros comandos para executar a aplica√ß√£o. Veja a tabela abaixo:

| Comando               | Descri√ß√£o                                                    |
| --------------------- | ------------------------------------------------------------ |
| **npm run start**     | Executa o projeto de forma direta, sem exibir o log (os detalhes) da execu√ß√£o. Caso ocorra um erro ser√° necess√°rio parar a aplica√ß√£o, corrigir o erro e executar novamente. |
| **npm run start:dev** | Executa o projeto de forma detalhada, exibindo o log da execu√ß√£o. Al√©m disso, caso ocorra algum erro, voc√™ n√£o precisa parar a execu√ß√£o, basta corrigir o erro, salvar e o Nest reiniciar√° o seu projeto automaticamente. |
| **npm run build**     | Executa o projeto e gera o Build (vers√£o final para o deploy na nuvem) |

Observe que depois de executar o projeto, o c√≥digo ser√° compilado e uma nova pasta ser√° criada dentro da pasta raiz do projeto. A nova pasta se chama **dist**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/PCmpHNW.png" title="source: imgur.com" /></div>

Dentro desta pasta est√£o todos os arquivos **JavaScript** gerados durante a compila√ß√£o. S√£o estes arquivos que fazem a sua aplica√ß√£o ser executada. Todas a vezes que voc√™ executar a sua aplica√ß√£o, esta pasta ser√° atualizada com as novas implementa√ß√µes que voc√™ inseriu no seu c√≥digo.

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/cli/usages" target="_blank"><b>Documenta√ß√£o: <i>Nest CLI - Scripts de execu√ß√£o</i></b></a></div>

<br />

<h2>üë£ Passo 06 - Testar no Insomnia</h2>

Para testar a aplica√ß√£o, utilizaremos o aplicativo **Insomnia**. 

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes! Para testar a aplica√ß√£o √© fundamental que a aplica√ß√£o esteja em execu√ß√£o (npm run start:dev).* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="left"><img src="https://i.imgur.com/g1HCNZy.png" title="source: imgur.com" width="30px" /><a href="https://insomnia.rest/" target="_blank"><b>Site Oficial do Insomnia</b></a></div>

<br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="80px"/> | <div align="left"> **DICA:** *Caso voc√™ tenha alguma d√∫vida quanto a instala√ß√£o do Insomnia, consulte o <a href="../00_ambiente/05_install_Insomnia.md" >Guia de Instala√ß√£o do Insomnia.</a>* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

O Insomnia √© um API Client que simplifica o processo de desenvolvimento do back-end de uma aplica√ß√£o WEB. O Insomnia permite criar, compartilhar e testar aplica√ß√µes WEB de forma simples e pr√°tica. O Insomnia permite aos  usu√°rios criar e salvar requisi√ß√µes **HTTP e HTTPS** (Request) desde as mais simples at√© as mais complexas, bem como ler as suas respostas HTTP (Response).

Para testar o nosso projeto hello-world, vamos criar uma requisi√ß√£o do tipo **GET**, onde iremos indicar o servidor (localhost), a porta padr√£o do Nest (3000) e o endere√ßo do recurso (/).

1. Na janela principal do Insomnia, clique no bot√£o **Create** e clique na op√ß√£o **Request Collection**.

<div align="center"><img src="https://i.imgur.com/OzaorsG.png" title="source: imgur.com" /></div>

2. Na janela que ser√° aberta, informe o nome da Collection (**Hello World**) e clique no bot√£o **Create** para concluir. 

<div align="center"><img src="https://i.imgur.com/9ps4Giq.png" title="source: imgur.com" /></div>

3. Na **Collection Hello World**, clique no bot√£o <img src="https://i.imgur.com/Igkx9ev.png" title="source: imgur.com" width="25px"/>. No menu que ser√° aberto, clique na op√ß√£o **New HTTP Request**.

<div align="center"><img src="https://i.imgur.com/abGJvpW.png" title="source: imgur.com" /></div>

4. Ser√° criada uma nova Requisi√ß√£o (New Request) dentro da collection **Hello World**.

<div align="center"><img src="https://i.imgur.com/1RLeYYk.png" title="source: imgur.com" /></div>

5. D√™ um duplo clique sobre a nova requisi√ß√£o (**New Request**), informe o nome da requisi√ß√£o (indicado na imagem abaixo na cor amarela) e pressione a tecla **enter** do seu teclado.

<div align="center"><img src="https://i.imgur.com/al39TxS.png" title="source: imgur.com" /></div>

6. Selecione o M√©todo HTTP que ser√° utilizado (**GET**) na requisi√ß√£o, indicado na imagem abaixo na cor verde. 

<div align="center"><img src="https://i.imgur.com/mWPpKHD.png" title="source: imgur.com" /></div>

7. Configure a requisi√ß√£o conforme a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/BshaIVE.png" title="source: imgur.com" /></div>

8. No item marcado em amarelo na imagem acima, informe o endere√ßo da Requisi√ß√£o. A requisi√ß√£o **Hello World** foi configurada da seguinte maneira:

- A primeira parte (http://localhost:3000/) √© o endere√ßo do servidor local e a requisi√ß√£o ser√° enviada para o endere√ßo raiz da aplica√ß√£o.

9. Para testar a requisi√ß√£o, com a aplica√ß√£o rodando, clique no bot√£o <img src="https://i.imgur.com/sy0V8Nx.png" title="source: imgur.com" width="50px"/>.

10. O resultado da requisi√ß√£o voc√™ confere na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/NhDqxZl.png" title="source: imgur.com" /></div>

11. Se a mensagem de boas vindas: **Hello World !!!** for exibida, a aplica√ß√£o est√° funcionando corretamente.

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/Marcelo7211/-nest-hello-world" target="_blank"><b>C√≥digo fonte do projeto</b></a></div>

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
