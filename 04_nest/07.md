<h1>Projeto 02 - Blog Pessoal - Classes PostagemController e PostagemService - M√©todo Consultar todas as Postagens</h1>



O que veremos por aqui:

1. Criar a Classe PostagemService
2. Criar a Classe PostagemController
3. Criar o m√©todo findAll() para listar todas as Postagens
4. Registrar as 2 Classes no M√≥dulo PostagemModule
5. Registrar o M√≥dulo PostagemModule no M√≥dulo APPModule
6. Testar o M√©todo findAll() no Insomnia

<br />

<h2>1. O M√≥dulo Postagem</h2>

Na etapa anterior, come√ßamos a construir o **M√≥dulo Postagem**, a partir da **Classe Entidade (Model) Postagem**, onde implementamos todos os atributos do recurso Postagem e geramos a tabela **tb_postagens** dentro do nosso Banco de dados **db_blogpessoal**. Agora vamos come√ßar a criar os M√©todos do CRUD do recurso Postagem, listados no Diagrama de Classes abaixo, nas Classes **PostagemService** e **PostagemController**.

<div align="center"><img src="https://i.imgur.com/EIm56Zk.png" title="source: imgur.com" width="75%"/></div>

Ser√£o implementados 6 M√©todos: 

- 3 M√©todos de Busca (GET)
- 1 M√©todo de Persist√™ncia dos Objetos no Banco de dados (POST)
- 1 M√©todo de Atualiza√ß√£o dos Objetos persistidos no Banco de dados (PUT)
- 1 M√©todo para apagar Objetos persistidos no Banco de dados (DELETE)

A Classe **PostagemService** ser√° a Classe de Servi√ßo do M√≥dulo Postagem, ou seja, onde implementaremos os M√©todos com as regras de neg√≥cio da aplica√ß√£o. A Classe **PostagemController** ser√° a Classe Controladora do M√≥dulo Postagem, ou seja, onde implementaremos os M√©todos respons√°veis por responder toda e qualquer Requisi√ß√£o (HTTP Request), que for enviada de fora da aplica√ß√£o para o recurso Postagem. 

> **Regras de neg√≥cio:**  O termo regras de neg√≥cio refere-se √†s **diretrizes que definem ou restringem as a√ß√µes, mostrando como os M√©todos devem funcionar, o que deve ser checado em cada M√©todo e quais s√£o os limites da aplica√ß√£o**. Essas regras s√£o importantes para que a pessoa desenvolvedora tenha uma vis√£o clara do que deve ser feito, como e por qual raz√£o.

N√≥s iremos implementar os m√©todos do **CRUD** nas duas Classes, com os mesmos nomes, mas com responsabilidades diferentes. O M√©todo da Classe de Servi√ßo far√° o processamento dos dados enviados na Requisi√ß√£o, enquanto O M√©todo da Classe Controladora receber√° as Requisi√ß√µes e enviar√° os dados para a Classe de Servi√ßo. Ap√≥s a conclus√£o do processamento da Requisi√ß√£o, A Classe Controladora enviar√° uma Resposta HTTP, definida a partir do retorno do M√©todo da Classe de Servi√ßo, al√©m do resultado do processamento do M√©todo da Classe de Servi√ßo. 

<br />

<h2>üë£ Passo 01 - Criar a Classe PostagemService</h2>



Vamos criar a pasta **services**, dentro do nosso **M√≥dulo Postagem** (pasta postagem):

1. Na pasta **postagem**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New Folder** (Nova Pasta). 

<div align="center"><img src="https://i.imgur.com/uCdfiD7.png" title="source: imgur.com" /></div>

2. O nome da pasta ser√° **services**, como mostra a figura abaixo. Ap√≥s digitar o nome da pasta, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/Yv9yU9I.png?1" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar a pasta services. Um erro muito comum √© criar a pasta services fora da pasta da pasta postagem.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

Na sequ√™ncia, vamos criar a Classe de Servi√ßo **PostagemService** que chamaremos de **postagem.service.ts**

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar Classe de Servi√ßo. Um erro muito comum √© digitar o nome da Classe de forma incorreta. O nome da Classe deve estar dentro dos padr√µes do Nest (nome_do_modulo.tipo_da_classe.ts) para evitar erros na sua aplica√ß√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

1. Clique com o bot√£o direito do mouse sobre a **pasta services**, que foi criada dentro da pasta **postagem**, como mostra a figura abaixo, e na sequ√™ncia clique na op√ß√£o **New File** (Novo Arquivo).

<div align="center"><img src="https://i.imgur.com/4ih83IQ.png" title="source: imgur.com" /></div>

2. O nome do arquivo ser√° **postagem.service.ts**, como mostra a figura abaixo. Ap√≥s digitar o nome do arquivo, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/pAlQSeP.png?1" title="source: imgur.com" /></div>

Agora vamos come√ßar a criar o c√≥digo da Classe **PostagemService**, como mostra a figura abaixo. Como iremos construir 6 M√©todos dentro da Classe de Servi√ßo, vamos construir por partes. Aqui construiremos apenas o primeiro M√©todo (**findAll()**), que tem como objetivo listar todas as Postagens persistidas no Banco de dados.

<div align="left"><img src="https://i.imgur.com/7XE7kiZ.png" title="source: imgur.com" /></div>

**Vamos analisar o c√≥digo:**

**Linha 1:** Importamos o pacote **Common** com os respectivos **decorators**, utilizados na implementa√ß√£o da Classe PostagemService.

**Linha 2:** Importamos o pacote **TypeORM** com os respectivos **decorators**, utilizados na implementa√ß√£o da Classe PostagemService.

**Linha 3:** Importamos a Classe **Repository**, do M√≥dulo **typeorm**, do pacote **Typeorm**. 

> A Classe **Repository** implementa dentro do TypeORM o padr√£o de desenvolvimento de software chamado de **Repository Pattern**. O Repository Pattern √© um padr√£o de Arquitetura de Software amplamente utilizado no desenvolvimento de software, especialmente no contexto de constru√ß√£o de aplicativos escal√°veis e de f√°cil manuten√ß√£o. Ele fornece uma abordagem estruturada para acessar e manipular dados, separando a l√≥gica de neg√≥cios da l√≥gica de acesso a dados. 

**Linha 4:** Importamos a Classe Entidade **Postagem**, do M√≥dulo **Postagem**.

**Linha 6:** O decorador **@Injectable** indica que a classe √© do tipo Service (Classe de Servi√ßo), ou seja, uma Classe que pode ser Injetada em outras Classes atrav√©s da **Inje√ß√£o de Depend√™ncias**.

> **Inje√ß√£o de depend√™ncia** √© um padr√£o de projeto que visa reduzir o acoplamento entre as classes em um sistema. Em vez de depender diretamente de implementa√ß√µes concretas, as classes podem depender de interfaces ou abstra√ß√µes. 

**Linha 8:** Cria o m√©todo **Construtor**, que receber√° as **Inje√ß√µes de Depend√™ncia** necess√°rias para o desenvolvimento da Classe de Servi√ßo.

**Linhas 9:** O decorador **@InjectRepository(Postagem)** tem a fun√ß√£o de indicar a Classe Entidade que ser√° utilizada pela Inje√ß√£o de Depend√™ncia da Classe Repository. Na Classe PostagemService, o decorador `@InjectRepository(Postagem)` informa ao Nest que a Inje√ß√£o de Depend√™ncia da Classe Repository `postagemRepository` est√° associada a Entidade `Postagem` .

> **Invers√£o de Controle (IoC)** √© um princ√≠pio de design de programas de computadores que altera a sequ√™ncia de chamadas de m√©todos em rela√ß√£o √† programa√ß√£o tradicional. Em vez de ser determinada diretamente pelo programador, a sequ√™ncia de controle √© invertida. 
>
> Antes de entender a IoC, √© importante mencionar o forte acoplamento. Isso ocorre quando objetos dependem diretamente de outros elementos espec√≠ficos para existir. O forte acoplamento dificulta a manuten√ß√£o, pois altera√ß√µes em um elemento podem afetar outros devido √†s depend√™ncias entre eles.
>
> A IoC no Nest √© implementada por meio da **Inje√ß√£o de Depend√™ncia** (**Dependency Injection**). Nesse padr√£o, as depend√™ncias de um objeto n√£o s√£o definidas diretamente dentro dele durante a cria√ß√£o. Em vez disso, elas s√£o inseridas dinamicamente, de acordo com alguma configura√ß√£o mut√°vel. Isso torna o sistema mais flex√≠vel e modular.
>
> A Invers√£o de Controle (IoC) representa o principio da **invers√£o de depend√™ncia (Dependency Inversion Principle - DIP)**, que √© um dos cinco princ√≠pios do padr√£o **SOLID**, essenciais para a programa√ß√£o orientada a objetos. O DIP prop√µe o seguinte:
>
> 1. **M√≥dulos de alto n√≠vel n√£o devem depender de m√≥dulos de baixo n√≠vel.** Ambos devem depender de abstra√ß√µes.
> 2. **Abstra√ß√µes n√£o devem depender de detalhes.** Detalhes devem depender de abstra√ß√µes.

A grande vantagem de se utilizar a Inje√ß√£o de Depend√™ncias √© que voc√™ consegue instanciar e acessar os Objetos sem a necessidade de criar/instanciar Objetos de forma manual, semelhante ao que era feito na Programa√ß√£o Orientada √† Objetos no modo Console.

> A Classe **Repository**, do Framework TypeORM nos auxilia na intera√ß√£o com o Banco de dados. Esta Classe cont√©m diversos  m√©todos pr√©-implementados para a manipula√ß√£o dos dados de uma Entidade, como os m√©todos para salvar, deletar, consultar e atualizar os dados dos objetos persistidos no Banco de dados na forma de registros em uma tabela. 
>
> Outra vantagem da Classe Repository √© que os M√©todos de consulta permitem criar praticamente qualquer consulta SQL que voc√™ precisar, de forma simples e r√°pida, sem utilizar c√≥digo SQL.

**Linha 10:** Definimos o nome do Objeto da Classe **Repository** (**postagemRepository**), que ser√° respons√°vel por implementar a **Inje√ß√£o de Depend√™ncias** e executar os M√©todos da Classe Repository.

Observe que ao criarmos a Inje√ß√£o de Depend√™ncia **postagemRepository**, estamos passando como **Tipo Gen√©rico (Generics)** da Classe Repository a Classe Entidade Postagem. Ao adotarmos esta pr√°tica, estamos implementando os princ√≠pios da Invers√£o de Controle, que podem ser observados atrav√©s das caracter√≠sticas abaixo:

- A Classe Repository **depende de Abstra√ß√µes**, pois da mesma forma que ela recebeu como Tipo Gen√©rico a Classe Entidade Postagem, ela tamb√©m poderia receber qualquer outra Classe Entidade (`Repository<T>`).
- A Classe Repository n√£o possui **Forte Acoplamento** com outras Classes, ou seja, a Classe Repository n√£o depende diretamente de outras Classes para existir.
- Os M√©todos da Classe Repository est√£o implementados de modo a trabalhar com qualquer Classe Entidade que for passada como Tipo Gen√©rico.

**Linha 13:** Criamos o M√©todo Ass√≠ncrono (async), chamado **findAll()**, que promete retornar uma **Promise** contendo um array de Objetos da Classe Postagem. Como o M√©todo findAll() lista v√°rios Objetos √© necess√°rio criar um array para armazenar todos os Objetos.

> **Fun√ß√µes Ass√≠ncronas** s√£o fun√ß√µes que podem ser executadas em segundo plano, enquanto o restante do c√≥digo continua sua execu√ß√£o. Essas fun√ß√µes s√£o especialmente √∫teis para opera√ß√µes que podem levar algum tempo para serem conclu√≠das, como Requisi√ß√µes HTTP para uma API, por exemplo, que n√£o conseguimos prever o tempo exato de conclus√£o.

**Linha 14:** Retorna a execu√ß√£o do M√©todo **find()**, do objeto **postagemRepository** (Inje√ß√£o de Depend√™ncia). Tra√ßando um paralelo com as instru√ß√µes SQL, o M√©todo find(), sem nenhum par√¢metro, seria o equivalente a instru√ß√£o SQL: <code>SELECT * FROM tb_postagens;</code>, que lista todas as postagens da Tabela tb_postagens. 

> O M√©todo find() da Classe Repository, √© respons√°vel por criar e executar instru√ß√µes do tipo **SELECT** no Banco de dados Relacional. Atrav√©s da **Classe Entidade**, o M√©todo identifica qual √© o **nome da tabela** e quais s√£o os **atributos da tabela**. Lembre-se que a Classe Entidade √© respons√°vel por definir o modelo de dados de um Recurso.

Observe que na instru√ß√£o **return** foi inserido o comando **await** (aguarde), que na pr√°tica significa espere que a **Promise** seja resolvida, ou seja, que todos os Objetos Postagem persistidos na tabela tb_postagens, sejam inseridos no array de Objetos Postagem, que ser√° devolvido pela Promise, antes de retornar a execu√ß√£o do M√©todo a Classe que acionou o M√©todo. Existe tamb√©m a possibilidade da Promise n√£o ser resolvida, como por exemplo, o servidor estar indispon√≠vel.

> **Promise** √© um Objeto JavaScript/TypeScript utilizado para o **Processamento Ass√≠ncrono**. Na pr√°tica, uma Promise √© uma promessa, que representa um valor que pode estar dispon√≠vel agora, no futuro ou nunca (erro). 
>
> Uma **Promise** √© como um "procurador" para um valor que n√£o √© necessariamente conhecido quando a promessa √© criada. Isso permite a associa√ß√£o de m√©todos de tratamento para eventos da a√ß√£o ass√≠ncrona num caso eventual de sucesso ou de falha. Isto permite que os m√©todos ass√≠ncronos retornem valores como m√©todos s√≠ncronos: ao inv√©s do valor final, o m√©todo ass√≠ncrono retorna uma promessa de que receber√° o valor em algum momento no futuro.
>
> Observe na imagem abaixo, que uma **Promise** possui tr√™s estados:
>
> <div align="center"><img src="https://i.imgur.com/CoxH7Yw.png" title="source: imgur.com" /></div>
>
>   - **pending** (pendente): Estado inicial, que n√£o foi nem resolvida e nem rejeitada.
> - **fulfilled** (resolvida): sucesso na opera√ß√£o.
> - **rejected** (rejeitado):  falha na opera√ß√£o.
>
> Abaixo, vemos como criar uma Promise
>
>   **Sintaxe:**
>
>   ```ts
>   new Promise( ( resolve, reject ) => { } )
>   ```
>
>   - **resolve**: fun√ß√£o, geralmente uma **Arrow Function**, que ser√° utilizada para retornar o resultado da Promise.
>   - **reject**: fun√ß√£o, geralmente uma **Arrow Function**, que ser√° utilizada para para retornar o erro da Promise.
>
> As palavras-chave **async** e **await**, representam uma sintaxe (outra forma de escrever uma Promise), criada com objetivo de simplificar a programa√ß√£o ass√≠ncrona, facilitando o fluxo de escrita e leitura do c√≥digo. Em outras palavras, **torna poss√≠vel escrever um c√≥digo que funciona de forma ass√≠ncrona, por√©m √© lido e estruturado de forma s√≠ncrona**. O **async/await** tamb√©m trabalha com o c√≥digo ass√≠ncrono baseado em Promises, por√©m esconde as promessas para que a leitura e a escrita sejam mais limpas.
>
> Ao declarar uma fun√ß√£o com a palavra reservada **async**, n√≥s poderemos utilizar a palavra-chave **await** antes de qualquer fun√ß√£o que retorne uma promise. Dessa forma, a execu√ß√£o da fun√ß√£o externa (a fun√ß√£o async), ser√° pausada at√© que a Promise seja resolvida.
>
> A palavra-chave **await** recebe uma Promise e a transforma em um valor de retorno (ou lan√ßa uma exce√ß√£o em caso de erro). Quando utilizamos o **await**, o TypeScript/JavaScript vai aguardar at√© que a Promise seja finalizada. Se for finalizada com sucesso (o termo utilizado √© *fulfilled*), o valor obtido √© retornado. Se a Promise for rejeitada (o termo utilizado √© *rejected*), √© retornado o erro lan√ßado pela exce√ß√£o.

Na pr√°tica, Isso significa que uma Requisi√ß√£o HTTP √© feita em segundo plano, enquanto a aplica√ß√£o continua  funcionando normalmente, sem bloquear o Backend. Quando o processamento da Requisi√ß√£o √© conclu√≠do, o Nest se encarrega de enviar uma Resposta HTTP com o respectivo Status, indicando o sucesso ou a falha.

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores - Classe de Servi√ßo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/fundamentals/custom-providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores Customizados - Classe de Servi√ßo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/techniques/database" target="_blank"><b>Documenta√ß√£o: <i>Interface Reposit√≥rio</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/working-with-repository" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Reposit√≥rios</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/find-options" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - M√©todo de busca find()</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank"><b>Documenta√ß√£o: Fun√ß√µes Ass√≠ncronas</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><b>Documenta√ß√£o: Promise</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/async_function" target="_blank"><b>Documenta√ß√£o: Async</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/await" target="_blank"><b>Documenta√ß√£o: Await</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/blob/04_Listar_Postagens/blogpessoal/src/postagem/services/postagem.service.ts" target="_blank"><b>C√≥digo fonte da Classe PostagemService</b></a></div>


<br />

<h2>üë£ Passo 02 - Criar a Classe PostagemController</h2>



Vamos criar a pasta **controllers**, dentro do nosso **M√≥dulo Postagem** (pasta postagem):

1. Na pasta **postagem**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New Folder** (Nova Pasta). 

<div align="center"><img src="https://i.imgur.com/xNQlpAd.png" title="source: imgur.com" /></div>

2. O nome da pasta ser√° **controllers**, como mostra a figura abaixo. Ap√≥s digitar o nome da pasta, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/i9iN8Rh.png?1" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar a pasta controllers. Um erro muito comum √© criar a pasta controllers fora da pasta postagem.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

Na sequ√™ncia, vamos criar a Classe Controladora **PostagemController** que chamaremos de **postagem.controller.ts**.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar Classe de Servi√ßo. Um erro muito comum √© digitar o nome da Classe de forma incorreta. O nome da Classe deve estar dentro dos padr√µes do Nest (nome_do_modulo.tipo_da_classe.ts) para evitar erros na sua aplica√ß√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

1. Clique com o bot√£o direito do mouse sobre a **pasta controllers**, que foi criada dentro da pasta **postagem**, como mostra a figura abaixo, e clique na op√ß√£o **New File** (Novo Arquivo).

<div align="center"><img src="https://i.imgur.com/bvtqoYT.png" title="source: imgur.com" /></div>

2. O nome do arquivo ser√° **postagem.controller.ts**, como mostra a figura abaixo. Ap√≥s digitar o nome do arquivo, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/HaoDWSZ.png?1" title="source: imgur.com" /></div>

Agora vamos come√ßar a criar o c√≥digo da Classe **PostagemController**, como mostra a figura abaixo. Como iremos construir 6 M√©todos dentro da Classe Controladora, vamos construir por partes. Aqui construiremos apenas o primeiro M√©todo, o **findAll()**, que tem como objetivo executar o M√©todo com o mesmo nome na **Classe PostagemService**.

<div align="left"><img src="https://i.imgur.com/WG0tKT3.png" title="source: imgur.com" /></div>

**Vamos analisar o c√≥digo:**

**Linha 1:** Importamos o pacote **Common** com os respectivos **decorators**, utilizados na implementa√ß√£o da Classe PostagemController.

**Linha 2:** Importamos a Classe **Postagem**, do M√≥dulo **Postagem**.

**Linha 3:** Importamos a Classe **PostagemService**, do M√≥dulo **Postagem**.

**Linha 5:** O decorador **@Controller** indica que a classe √© do tipo **RestController**, ou seja, ser√° um Classe que receber√° Requisi√ß√µes HTTP que ser√£o compostas por:

- **URL:** Endere√ßo da requisi√ß√£o (**endpoint**)
- **Verbo:** Define qual m√©todo HTTP ser√° acionado na Classe controladora.
- **Corpo da requisi√ß√£o (Request Body):** Objeto que cont√©m os dados que ser√£o persistidos no Banco de dados. Apenas as Requisi√ß√µes do tipo POST e PUT conseguem enviar dados no Corpo da Requisi√ß√£o.

Ap√≥s receber e processar a requisi√ß√£o, a Classe Controladora Responder√° com:

- Um **C√≥digo de Status HTTP** pertinente a opera√ß√£o que est√° sendo realizada.
- O resultado do processamento (Objetos de uma Classe, por exemplo) inserido diretamente no corpo da resposta (**Response Body**)

O par√¢metro inserido dentro dos par√™nteses do decorador **@Controller** √© usado para definir o caminho do Recurso Postagem. Em outras palavras, todas as requisi√ß√µes enviadas para o caminho **/postagens**, ser√£o respondidas pela classe controladora **PostagemController**. Ao digitar a URL do servidor seguida do caminho do Recurso Postagem (**http://localhost:4000/postagens**), a Classe Controladora PostagemController, enviar√° a Requisi√ß√£o para o Respectivo M√©todo, de acordo com o verbo HTTP (GET, POST, PUT ou DELETE) e os par√¢metros inseridos na URL.

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao configurar a URL do M√≥dulo. Observe que configuramos a URL (/postagens) iniciando com uma barra, com letras min√∫sculas, usando o mesmo nome do m√≥dulo no plural, sem acentos, caracteres especiais e espa√ßos em branco. Lembre-se que todos os endere√ßos na WEB seguem este padr√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

**Linha 7:** Cria um Construtor, que receber√° as Inje√ß√µes de Depend√™ncia. Como precisaremos ter acesso aos M√©todos da **Classe PostagemService**, foi criada uma Inje√ß√£o de Depend√™ncia da Classe Postagem Service, chamada **postagemService**, dentro do Construtor da Classe.

**Linha 9:** O decorador **@Get()** mapeia todas as Requisi√ß√µes **HTTP GET**, enviadas para um endere√ßo espec√≠fico, chamado **endpoint**, dentro do M√≥dulo Postagem, para um M√©todo espec√≠fico que responder√° a Requisi√ß√£o, ou seja, ele indica que o M√©todo **findAll()**, responder√° a todas as requisi√ß√µes do tipo **HTTP GET**, enviadas no endere√ßo **http://localhost:4000/postagens/**.

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ATEN√á√ÉO:** *O Endere√ßo do endpoint ser√° igual ao Endere√ßo do M√≥dulo apenas quando o decorador @Get() n√£o possuir um endere√ßo personalizado, como um par√¢metro por exemplo. Caso existam dois ou mais m√©todos do tipo GET ser√° necess√°rio personalizar o endere√ßo de cada M√©todo decorado com @Get("/<endere√ßo_personalizado>").* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

**Linha 10:** O decorador **@HttpCode(HttpStatus.OK)** indica que o M√©todo **findAll()**, ter√° como **Resposta HTTP** padr√£o o HTTP Status **OK ü°™ 200**, ou seja, quando a Resposta da Requisi√ß√£o for positiva, ser√° retornado o **HTTP Status OK ü°™ 200**. Caso a Resposta seja negativa (algo deu errado), a Resposta depender√° do erro.

**Linha 11:** Criamos o M√©todo **findAll()**, que promete retornar uma **Promise** (que ser√° resolvida pela Classe PostagemService), contendo um array com todos os Objetos Postagem persistidos no Banco de dados. 

**Linha 12:** Executa o m√©todo **findAll()** (**M√©todo da Classe PostagemService**), que retornar√° **todos os Objetos da Classe Postagem** persistidos no Banco de dados dentro de um array. 

<br />

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Methods" target="_blank"><b>Documenta√ß√£o: HTTP Methods Request</b></a></div>

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Status" target="_blank"><b>Documenta√ß√£o: HTTP Status Code</b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/controllers" target="_blank"><b>Documenta√ß√£o: <i>Classe Controladora</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores - Classe Controladora</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/blob/04_Listar_Postagens/blogpessoal/src/postagem/controllers/postagem.controller.ts" target="_blank"><b>C√≥digo fonte da Classe PostagemController</b></a></div>


<br />

<h2>üë£ Passo 03 - Registrar as Classes PostagemService e PostagemController na Classe PostagemModule</h2>



Na sequ√™ncia, vamos registrar as nossas duas Classes **(PostagemService** e **PostagemController**), no M√≥dulo **PostagemModule**. Este passo √© fundamental para o correto funcionamento da nossa aplica√ß√£o.

1. Abra a Classe **PostagemModule**, localizada na pasta **postagem**, conforme indicada na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/2j3S9em.png?1" title="source: imgur.com" /></div>

2. Implemente as altera√ß√µes, indicadas pelas setas na imagem abaixo:

<div align="left"><img src="https://i.imgur.com/25kuNlw.png" title="source: imgur.com" /></div>

**Vamos analisar as altera√ß√µes no c√≥digo:**

**Linha 3:** Importamos a Classe **PostagemController**, criada anteriormente. 

**Linha 5:** Importamos a Classe **PostagemService**, criada anteriormente. 

**Linha 9:** No array **providers** vamos adicionar a **Classe PostagemService** do **M√≥dulo Postagem**. Desta forma a Classe de Servi√ßo poder√° ser injetada em outras Classes dentro do M√≥dulo.

**Linha 10:** No array **controllers** vamos adicionar a **Classe PostagemController** do **M√≥dulo Postagem**. Desta forma os endpoints da Classe Controladora estar√£o dispon√≠veis para receber Requisi√ß√µes HTTP.

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/modules" target="_blank"><b>Documenta√ß√£o: <i>M√≥dulos no Nest</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/blob/04_Listar_Postagens/blogpessoal/src/postagem/postagem.module.ts" target="_blank"><b>C√≥digo fonte da Classe PostagemModule</b></a></div>

<br />

<h2>üë£ Passo 04 - Registrar o M√≥dulo PostagemModule no M√≥dulo AppModule</h2>



Para finalizar, vamos registrar a Classe **Postagem** no M√≥dulo principal da  aplica√ß√£o, a Classe **AppModule**. 

1. Abra a Classe **AppModule**, localizada na pasta **src**, conforme indicada na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/EBmrCf4.png" title="source: imgur.com" /></div>

2. Implemente as duas altera√ß√µes, indicadas pelas setas na imagem abaixo:

<div align="left"><img src="https://i.imgur.com/Fz82a8t.png" title="source: imgur.com" /></div>

**Vamos analisar o c√≥digo:**

**Linha 4:** Importamos o M√≥dulo **PostagemModule**.

**Linha 18:** No array **imports** vamos inserir o M√≥dulo **PostagemModule**.

<br />

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ATEN√á√ÉO:** *Se o M√≥dulo PostagemModule, n√£o for registrado no M√≥dulo principal da aplica√ß√£o (AppModule), os endpoints da aplica√ß√£o n√£o ficar√£o dispon√≠veis para serem consumidos pelo Insomnia ou pelo Frontend.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/modules" target="_blank"><b>Documenta√ß√£o: <i>M√≥dulos no Nest</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/blob/04_Listar_Postagens/blogpessoal/src/app.module.ts" target="_blank"><b>C√≥digo fonte da Classe AppModule</b></a></div>

<br />

<h2>üë£ Passo 05 - Executar o projeto</h2>



1. Verifique se voc√™ est√° dentro da pasta do projeto, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/JgNkmDv.png" title="source: imgur.com" /></div>

2. Digite o comando ***npm run start:dev***, para compilar e executar o nosso projeto **blogpessoal**. 

```bash
npm run start:dev
```

3. Se tudo deu certo, o resultado ser√° semelhante ao da figura abaixo:

<div align="center"><img src="https://i.imgur.com/hGAUI1Z.png" title="source: imgur.com" /></div>

4. Observe na imagem acima, na regi√£o destacada em amarelo, que o endpoint do tipo **GET** , apontando para o caminho (rota) **/postagens**, foi disponibilizado (mapeado).

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/tree/04_Listar_Postagens" target="_blank"><b>C√≥digo fonte do projeto</b></a></div>

<br />

<h2>üë£ Passo 06 - Inserir dados no Banco de dados</h2>



Como ainda n√£o criamos um M√©todo para Cadastrar Postagens (criaremos em breve), vamos inserir dois registros diretamente no Banco de Dados **db_blogpessoal**  na Tabela **tb_postagens** para testarmos o nosso M√©todo findAll().

1. Abra o <b>MySQL Workbench</b>.

2. Crie um novo arquivo SQL **(SQLFile)** e digite os comandos abaixo:

   ```sql
   USE db_blogpessoal;
   
   INSERT INTO tb_postagens (data, texto, titulo) 
   VALUES (current_timestamp(), 'Texto da postagem 01', 'Postagem 01');
   INSERT INTO tb_postagens (data, texto, titulo) 
   VALUES (current_timestamp(), 'Texto da postagem 02', 'Postagem 02');
   
   SELECT * FROM tb_postagens;
   ```

3. Selecione todas as linhas e clique no primeiro raio <img src="https://i.imgur.com/xH6Ei9O.png" title="source: imgur.com" /> para inserir os dados na tabela **tb_postagens**.

<div align="center"><img src="https://i.imgur.com/6yEc6tE.png" title="source: imgur.com" /></div>

4. A imagem acima mostra que os dados foram inseridos com sucesso!

<br />

<h2>üë£ Passo 07 - Testar no Insomnia</h2>



Para testar a aplica√ß√£o, utilizaremos o **Insomnia**. 

Para organizar os nossos testes, vamos criar uma **Collection** para guardar todas as nossas **Requisi√ß√µes do Projeto Blog Pessoal**. Na sequ√™ncia vamos criar dentro da Collection uma pasta chamada **Postagem** para guardar todas as requisi√ß√µes do M√≥dulo Postagem. Para concluir, vamos criar uma requisi√ß√£o do tipo **GET**, dentro da pasta Postagem, para testar o nosso M√©todo **findAll()**.

<br />

<h3>7.1. Criando a Collection Blog Pessoal</h3>



1. Na janela principal do **Insomnia**, clique no bot√£o **Create** e clique na op√ß√£o **Request Collection**.

<div align="center"><img src="https://i.imgur.com/NhdF4d0.png" title="source: imgur.com" /></div>

2. Na janela que ser√° aberta, informe o nome da Collection (**Blog Pessoal**) e clique no bot√£o **Create** para concluir. 

<div align="center"><img src="https://i.imgur.com/eYp2qUL.png" title="source: imgur.com" width="80%"/></div>

<br />

<h3>7.2. Criando a  Pasta Postagem</h3>



Vamos criar dentro da **Collection Blog Pessoal**, na **Pasta Postagem**, que guardar√° todas as requisi√ß√µes do **M√≥dulo Postagem**.

1. Na **Collection Blog Pessoal**, clique no bot√£o <img src="https://i.imgur.com/3Ou2SAZ.png" title="source: imgur.com" width="6%"/>. No menu que ser√° aberto, clique na op√ß√£o **New Folder**.

<div align="center"><img src="https://i.imgur.com/gIGZFHc.png" title="source: imgur.com" /></div>

2. Na janela que ser√° aberta, informe o nome da pasta (**Postagem**) e clique no bot√£o **Create** para concluir. 

<div align="center"><img src="https://i.imgur.com/2rUhRGT.png" title="source: imgur.com" width="80%"/></div>

<br />

<h3>7.3. Criando a  Requisi√ß√£o - Consultar todas as postagens - findAll()</h3>



Agora vamos criar a Requisi√ß√£o para o **M√©todo findAll()**:

1. Clique com o bot√£o direito do mouse sobre a **Pasta Postagem** para abrir o menu e clique na op√ß√£o **New HTTP Request**.

<div align="center"><img src="https://i.imgur.com/KvRI8b2.png" title="source: imgur.com" /></div>

2. Ser√° criada uma nova Requisi√ß√£o (New Request) dentro da pasta **Postagem**.

<div align="center"><img src="https://i.imgur.com/ZIi9kJp.png" title="source: imgur.com" /></div>

3. D√™ um duplo clique sobre a nova requisi√ß√£o (**New Request**), informe o nome da requisi√ß√£o (indicado na imagem abaixo na cor amarela) e pressione a tecla **enter** do seu teclado.

<div align="center"><img src="https://i.imgur.com/3eD6Zwy.png" title="source: imgur.com" /></div>

4. Selecione o M√©todo HTTP que ser√° utilizado (**GET**) na requisi√ß√£o, indicado na imagem abaixo na cor verde. 

<div align="center"><img src="https://i.imgur.com/mWPpKHD.png" title="source: imgur.com" /></div>

5. Configure a requisi√ß√£o conforme a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/NXrdnR4.png" title="source: imgur.com" /></div>

6. No item marcado em amarelo na imagem acima, informe o endere√ßo do endpoint da Requisi√ß√£o. A Requisi√ß√£o **Consultar Todas as postagens** foi configurada da seguinte maneira:

- A primeira parte do endere√ßo (**http://localhost:4000**) √© o endere√ßo do nosso servidor local. Quando a aplica√ß√£o estiver na nuvem, ele ser√° substitu√≠do pelo endere√ßo da nuvem.
- A segunda parte do endere√ßo √© o **endpoint** configurado no decorador ***@Controller()***, em nosso caso  **/postagens**. 

7. Para testar a requisi√ß√£o, com a aplica√ß√£o rodando, clique no bot√£o <img src="https://i.imgur.com/sy0V8Nx.png" title="source: imgur.com" width="60px"/>.

8. O resultado da requisi√ß√£o voc√™ confere na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/iUfzYul.png" title="source: imgur.com" width="75%"/></div>

9. Observe que a aplica√ß√£o al√©m de exibir os dados de todos os Objetos da Classe Postagem persistidos no Banco de dados, no Corpo da Resposta, ela tamb√©m retornar√° um **HTTP Status 200 ü°™ OK** (indicado em verde na imagem acima), informando que a Requisi√ß√£o foi bem sucedida!
9. Caso o Projeto Nest n√£o esteja em Execu√ß√£o, o Insomnia retornar√° a mensagem abaixo:

<div align="center"><img src="https://i.imgur.com/Y2iNu9v.png" title="source: imgur.com" /></div>

11. Execute o seu Projeto e teste novamente!

<br />

<div align="left"><img src="https://i.imgur.com/g1HCNZy.png" title="source: imgur.com" width="30px" /><a href="https://docs.insomnia.rest/" target="_blank"><b>Documenta√ß√£o: Insomnia Rest</b></a></div>

<div align="left"><img src="https://i.imgur.com/14IR5P4.png" title="source: imgur.com" width="4%"/><a href="https://www.json.org/json-pt.html" target="_blank"><b>Site Oficial do JSON</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/tree/04_Listar_Postagens" target="_blank"><b>C√≥digo fonte do projeto</b></a></div>

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
