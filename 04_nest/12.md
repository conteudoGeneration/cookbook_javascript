<h1>Projeto 02 - Blog Pessoal - Relacionamento entre Classes - M√≥dulo Tema - Parte 01</h1>

O que veremos por aqui:

1. Apresenta√ß√£o do M√≥dulo Tema
2. Criar o M√≥dulo Tema
3. Criar a Classe Entidade Tema
4. Criar a Classe M√≥dulo TemaModule
5. Registrar a Classe Tema na Classe TemaModule
6. Registrar a Classe Tema e TemaModule na Classe AppModule
7. Criar o Relacionamento entre as Classes Postagem e Tema

<h2>1. O M√≥dulo Tema</h2>

Nesta etapa vamos come√ßar a construir o M√≥dulo Tema. Veja o Diagrama de Classes abaixo: 

<div align="center"><img src="https://i.imgur.com/ztkFmkP.png" title="source: imgur.com" width="75%"/></div>

A **Classe Tema** servir√° de modelo para construir a tabela **tb_temas** (Entidade) dentro do nosso Banco de dados **db_blogpessoal**. Os campos (Atributos) da tabela ser√£o os mesmos que est√£o definidos no Diagrama de Classes acima. **Al√©m de construirmos a Classe Tema, tamb√©m faremos o Relacionamento com a Classe Postagem**, constru√≠da anteriormente. 

Na pr√≥xima etapa vamos construir as Classes **TemaService e TemaController**, que ir√° nos auxiliar na intera√ß√£o com o Banco de dados e onde ser√£o implementados os 6 m√©todos descritos no Diagrama de Classes acima.

Depois de criar a Classe Entidade Tema, vamos executar o projeto Blog Pessoal. Ap√≥s a execu√ß√£o veremos que ser√° criado no Banco de dados **db_blogpessoal** a tabela **tb_temas**. Veja abaixo como ficar√° a estrutura da nossa tabela atrav√©s do **Diagrama de Entidade e Relacionamentos (DER)**:

<div align="center"><img src="https://i.imgur.com/Ci4FVLl.jpg" title="source: imgur.com" width="60%"/></div>

O Dicion√°rio de dados da nossa tabela tb_temas ser√° o seguinte:

| Atributo      | Tipo de dado | Descri√ß√£o           | Chave |
| ------------- | ------------ | ------------------- | ----- |
| **id**        | INT    | Identificador √∫nico | PK    |
| **descricao** | VARCHAR(255) | Tema  |       |

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar o M√≥dulo Tema. Todas as Classes constru√≠das no M√≥dulo Postagem dever√£o ser constru√≠das no M√≥dulo Tema com as adapta√ß√µes pertinentes ao M√≥dulo Tema.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="80px"/> | <div align="left"> **DICA:** *Caso voc√™ tenha alguma d√∫vida sobre como criar o M√≥dulo, executar o projeto, entre outras, consulte a Documenta√ß√£o do M√≥dulo Postagem.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2>üë£ Passo 01 - Criar o M√≥dulo Tema</h2>

Vamos criar o M√≥dulo Tema:

1. Na pasta **src**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New Folder** (Nova Pasta). 

2. O nome da pasta ser√° **tema**. Ap√≥s digitar o nome da pasta, pressione a tecla **enter** do seu teclado para concluir. 

Na sequ√™ncia, vamos criar a pasta **entities**, dentro do nosso **M√≥dulo Tema** (pasta tema):

1. Na pasta **tema**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New Folder** (Nova Pasta). 

2. O nome da pasta ser√° **entities** Ap√≥s digitar o nome da pasta, pressione a tecla **enter** do seu teclado para concluir. 
2. A estrutura de pasta do M√≥dulo Tema, ficar√° igual a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/dgJ0rzN.png?1" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="90px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar a Classe Entidade. Um erro muito comum √© criar a pasta entities fora da pasta do m√≥dulo (tema).* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2>üë£ Passo 02 - Criar a Classe TemaModule na pasta Tema</h2>

Agora vamos criar a Classe **TemaModule** que chamaremos de **tema.module.ts**.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar Classe Module. Um erro muito comum √© digitar o nome da Classe de forma incorreta. O nome da Classe deve estar dentro dos padr√µes do Nest para evitar erros na sua aplica√ß√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

1. Clique com o bot√£o direito do mouse sobre a **pasta tema**, que foi criada dentro da pasta **src** e clique na op√ß√£o **New File** (Novo Arquivo).

2. O nome do arquivo ser√° **tema.module.ts**. Ap√≥s digitar o nome do arquivo, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/gmFqj8o.png" title="source: imgur.com" /></div>

<h2>üë£ Passo 03 - Criar a Classe Entidade Tema</h2>

Antes de implementarmos o c√≥digo da Classe **TemaModule**, vamos criar a Classe Entidade **Tema** que chamaremos de **tema.entity.ts**.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar Classe Entidade. Um erro muito comum √© digitar o nome da Classe de forma incorreta. O nome da Classe deve estar dentro dos padr√µes do Nest para evitar erros na sua aplica√ß√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

1. Clique com o bot√£o direito do mouse sobre a **pasta entities**, que foi criada dentro da pasta **tema**, e clique na op√ß√£o **New File** (Novo Arquivo).

2. O nome do arquivo ser√° **tema.entity.ts**. Ap√≥s digitar o nome do arquivo, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/yA9d82r.png" title="source: imgur.com" /></div>

Agora vamos criar o c√≥digo da Classe **Tema**:

```typescript
import { IsNotEmpty } from "class-validator";
import { Column, Entity, PrimaryGeneratedColumn } from "typeorm";

@Entity({name: "tb_temas"})
export class Tema {

    @PrimaryGeneratedColumn()    
    id: number

    @IsNotEmpty()
    @Column({length: 255, nullable: false})
    descricao: string
    
}
```

Veja na tabela abaixo a convers√£o de **Tipo de dados TypeScript ü°™ MySQL, de acordo com o que foi definido no Diagrama de Classes acima:**

| Atributo   | Tipo de dado TypeScript                                   | Tipo de dado MySQL |
| ---------- | ------------------------------------------------------------ | ------------------ |
| **id**     | number | INT             |
| **descricao** | <i>string</i> | VARCHAR       |

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="100px"/> | <div align="left">**DICA:** *Para relembrar os tipos de dados do TypeScript, <a href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html">clique aqui</a> e explore os principais tipos de dados oferecidos pelo TypeScript.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

Observe que o c√≥digo √© semelhante ao da Classe Entidade **Postagem**, do M√≥dulo Postagem.

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/techniques/database" target="_blank"><b>Documenta√ß√£o: <i>Banco de dados com Nest</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/entities" target="_blank"><b>Documenta√ß√£o: <i>Entidades no TypeORM</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/6knlnLz.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/typestack/class-validator" target="_blank"><b>Documenta√ß√£o: <i>Pacote Validation</i></b></a></div>

<br />

<h2>üë£ Passo 04 - Registrar a Classe Tema na Classe TemaModule</h2>

Vamos implementar o c√≥digo da Classe **TemaModule** e registrar a Classe **Tema**. Veja abaixo a implementa√ß√£o da Classe **TemaModule**:

```typescript
import { Module } from "@nestjs/common";
import { TypeOrmModule } from "@nestjs/typeorm";
import { Tema } from "./entities/tema.entity";

@Module({
    imports: [TypeOrmModule.forFeature([Tema])],
    providers: [],
    controllers: [],
    exports: [TypeOrmModule]
})
export class TemaModule {}
```

Observe que o c√≥digo √© semelhante ao da Classe M√≥dulo **PostagemModule**, do M√≥dulo Postagem.

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ATEN√á√ÉO:** *Se uma Classe for importada com o caminho absoluto (src/entities/tema.entity.ts), os testes da aplica√ß√£o com o framework Jest n√£o ser√£o executados. O Jest n√£o reconhece caminho absoluto, apenas caminho relativo (./entities/tema.entity.ts)* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/modules" target="_blank"><b>Documenta√ß√£o: <i>M√≥dulos no Nest</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/blob/09_Recurso_Tema_Relacionamento/blogpessoal/src/tema/tema.module.ts" target="_blank"><b>C√≥digo fonte da Classe TemaModule</b></a></div>

<br />

<h2>üë£ Passo 05 - Registrar as Classes Tema e TemaModule na Classe AppModule</h2>

Para finalizar, vamos registrar a Classe **Tema** no M√≥dulo principal da  aplica√ß√£o, a Classe **AppModule**. 

1. Abra a Classe **AppModule**, localizada na pasta **src**, conforme indicada na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/DYMTorw.png" title="source: imgur.com" /></div>

2. Implemente as altera√ß√µes, indicadas pelas setas na imagem abaixo:

<div align="left"><img src="https://i.imgur.com/tfPxIKr.png" title="source: imgur.com" /></div>

Vamos analisar o c√≥digo:

**Linha 5:** Importamos a Classe **Tema**, criada anteriormente. Observe que na importa√ß√£o da Classe foi utilizado o caminho relativo (**./tema/entities/tema.entity.ts**) por quest√µes de boas pr√°ticas. 

**Linha 6:** Importamos a Classe **TemaModule**, criada anteriormente. Observe que na importa√ß√£o da Classe foi utilizado o caminho relativo (**./tema/tema.module.ts**) por quest√µes de boas pr√°ticas. 

**Linha 17:** No array **entities** vamos inserir a Classe **Tema**, ao lado da Classe **Postagem**, separadas por uma virgula.

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATEN√á√ÉO:** *Se uma Classe Entidade n√£o for registrada no M√≥dulo principal da aplica√ß√£o (AppModule), a tabela associada a Entidade n√£o ser√° criada no Banco de dados.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

**Linha 21:** No array **imports** vamos inserir o M√≥dulo **TemaModule**, abaixo da Classe **PostagemModule**, separadas por uma virgula.

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="80px"/>| <div align="left"> **ATEN√á√ÉO:** *Se um M√≥dulo n√£o for registrado no M√≥dulo principal da aplica√ß√£o (AppModule), n√£o ser√° poss√≠vel criar um Relacionamento com as Classes Entidades deste M√≥dulo.* </div>|
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/modules" target="_blank"><b>Documenta√ß√£o: <i>M√≥dulos no Nest</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/blob/09_Recurso_Tema_Relacionamento/blogpessoal/src/app.module.ts" target="_blank"><b>C√≥digo fonte da Classe AppModule</b></a></div>

<br />

<h2>üë£ Passo 06 - Executar o projeto</h2>

1. Verifique se voc√™ est√° dentro da pasta do projeto, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/67GK3fX.png" title="source: imgur.com" /></div>

2. Digite o comando ***npm run start:dev***, para compilar e executar o nosso projeto **blogpessoal**. 

```bash
npm run start:dev
```

3. Se tudo deu certo, o resultado ser√° semelhante ao da figura abaixo:

<div align="center"><img src="https://i.imgur.com/Fy3P1Wp.png" title="source: imgur.com" /></div>

4.Aparentemente n√£o mudou nada, mas vamos checar o Banco de dados...

<br />

<h2>üë£ Passo 07 - Checar o Banco de dados</h2>

1. Abra o **MySQL Workbench** 
1. Verifique se a tabela **tb_temas** foi criada no Banco de dados **db_blogpessoal**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/vqs36hU.png" title="source: imgur.com" /></div>

<br />

<h2>2. Relacionamento entre Classes</h2>

**Mapeamento Objeto-Relacional (ORM)** √© o processo de convers√£o das Classes em Tabelas (Entidades) no Banco de dados da aplica√ß√£o e vice-versa. Em outras palavras, isso nos permite interagir com um Banco de dados Relacional sem utilizar c√≥digo SQL. O **TypeORM** √© um framework que define como persistir dados em aplicativos TypeScript. O foco principal do TypeORM √© a camada ORM. Para mais detalhes, consulte o cookbook <a href="03.md" target="_blank"><b>Introdu√ß√£o ao TypeORM</b></a>.

O **TypeORM** simplifica o tratamento do modelo de Banco de dados Relacional nos aplicativos Nest quando mapeamos cada Tabela para uma √∫nica Classe Entidade (Model). Assim como no MySQL, precisamos criar o Relacionamento entre duas tabelas, no TypeORM tamb√©m precisamos criar o **Relacionamento entre as Classes** e desta forma ele construir√° os Relacionamento entre as duas Tabelas no Banco de dados assim como fizemos no MySQL. 

Nesta etapa vamos construir o Relacionamento do M√≥dulo Tema com o M√≥dulo Postagem, a partir das Classes Entidade Tema e Postagem. Veja o Diagrama de Classes abaixo: 

<div align="center"><img src="https://i.imgur.com/y7cmiCu.jpg" title="source: imgur.com" /></div>

Para construirmos o Relacionamento entre Classes, assim como no SQL, precisamos definir a cardinalidade do Relacionamento. Para definir a Cardinalidade, o TypeORM utiliza os decorators abaixo:

| Cardinalidade | Decorator   | Descri√ß√£o                                                    |
| ------------- | ----------- | ------------------------------------------------------------ |
| **1:1**       | @OneToOne   | No relacionamento OneToOne, um Objeto pode se relacionar com **apenas um √∫nico Objeto da Classe Relacionada**, ou seja, √© uma liga√ß√£o um para um. <br />No Banco de dados significa que cada linha de uma Entidade se refere a **<u>apenas</u>** uma linha de outra Entidade. |
| **1:N**       | @OneToMany  | No relacionamento OneToMany,  um Objeto pode se relacionar com **muitos Objetos da Classe Relacionada**.<br/>Em Bancos de dados relacionais, cada linha de uma Entidade √© referenciada a muitos registros filhos em outra Entidade.<br/>O importante √© que os registros filhos n√£o podem ter v√°rias m√£es. Em  uma rela√ß√£o OneToMany entre a Tabela A e a Tabela B, cada linha da Tabela A est√° ligada a 0, 1 ou muitas linhas da Tabela B.<br/>Numa Rela√ß√£o Unidirecional, a rela√ß√£o do tipo OneToMany porqu√™ o lado Um da rela√ß√£o manda no Relacionamento. |
| **N:1**       | @ManyToOne  | No relacionamento  ManyToOne,  um Objeto pode se relacionar com **outro Objeto que cont√©m valores √∫nicos**.<br/>Em Bancos de dados Relacionais, esses relacionamentos s√£o aplic√°veis usando o par Chave Estrangeira (Lado N da Rela√ß√£o) e a  Chave Prim√°ria (Lado 1 da Rela√ß√£o), entre as tabelas. O Lado N tamb√©m deve ter uma Chave Prim√°ria.<br />Numa Rela√ß√£o Bidirecional, essa anota√ß√£o ser√° utilizada para referenciar o Lado Um da Rela√ß√£o, atrav√©s de um Objeto, que funcionar√° como a Chave Estrangeira. |
| **N:M**       | @ManyToMany | No relacionamento ManyToMany,  **muitos Objetos podem se relacionar com muitos outros Objetos**.<br/>Em Bancos de dados Relacionais, o relacionamento Muitos para Muitos uma ou mais linhas de uma Entidade s√£o associadas a mais de uma linha em outra Entidade.<br />Os relacionamentos ManyToMany exigem um pouco mais de trabalho do que os outros relacionamentos.<br />Em um Banco de dados, um Relacionamento ManyToMany **envolve uma terceira Tabela intermedi√°ria**, que faz refer√™ncia a ambas as outras tabelas armazenando as 2 Chaves estrangeiras. |

No modelo Relacional, 1:N e N:1 s√£o a mesma coisa, entretanto no Relacionamento de Classes, al√©m da Cardinalidade √© necess√°rio definir a Dire√ß√£o do Relacionamento, ou seja, Se apenas a Classe M√£e exibe a Classe Filha (Unidirecional) ou se Classe Filha tamb√©m Exibir√° a Classe M√£e (Bidirecional), ao listar os dados em uma consulta.

No Modelo Relacional todo Relacionamento √© **Unidirecional**, ou seja, **apenas a Tabela que possui a Chave Estrangeira acessa a outra Tabela**. No Relacionamento de Classes, existe a possibilidade do Relacionamento ser **Bidirecional**, ou seja, uma **Classe acessa a outra e vice-versa, independente de possuir ou n√£o a Chave Estrangeira**.

Depois de criar o Relacionamento entre as Classes e executar o projeto Blog Pessoal, veremos que ser√° criado no MySQL a Rela√ß√£o entre as tabelas **tb_postagens** e **tb_temas** Unidirecional. Veja abaixo como ficar√° a estrutura da nossa tabela atrav√©s do **Diagrama de Entidade e Relacionamentos (DER)**:

<div align="center"><img src="https://i.imgur.com/ayrWIFY.jpg" title="source: imgur.com" /></div>

Como o TypeORM faz o mapeamento das Tabelas em Objetos, caso o Relacionamento Bidirecional esteja habilitado, a Rela√ß√£o funcionar√° independente do Banco de Dados ser Unidirecional.

Vamos construir o Relacionamento Bidirecional (1:N) entre as nossas Classes Tema e Postagem como veremos a seguir. 

<br />

<h2>üë£ Passo 01 - Criar a Rela√ß√£o ManytoOne na Classe Postagem</h2>

A Classe Postagem ser√° o lado N:1, ou seja, **Muitas Postagens podem ter apenas Um Tema**. Para criar a Rela√ß√£o vamos inserir depois do √∫ltimo atributo da Classe Postagem (data), as linhas destacadas em amarelo na figura abaixo:

<div align="left"><img src="https://i.imgur.com/moHa0tP.png?1" title="source: imgur.com" /></div>

**Linha 22:** O decorator **@ManyToOne** indica que a Classe Postagem ser√° o lado N:1 da rela√ß√£o e ter√° um **Objeto da Classe Tema**, chamado **tema**, que no modelo Relacional ser√° a **Chave Estrangeira na Tabela tb_postagens (temaId)**.

**Linha 23:** Os relacionamentos entre Entidades geralmente dependem da exist√™ncia de outra Entidade, por exemplo, o relacionamento **Tema ü°™ Postagem**, sem um Objeto Tema associado, a Entidade Postagem n√£o tem nenhum significado pr√≥prio, se tornando o que chamamos de **Objeto √ìrf√£o** (Orphan Object). **Quando exclu√≠mos um Objeto da Entidade Tema, todos os Objetos da Entidades Postagem associadas ao Tema exclu√≠do tamb√©m devem ser exclu√≠dos**, entretanto, o inverso n√£o √© verdadeiro. **"Cascatear" (cascade)**, √© a maneira de conseguirmos este efeito no Relacionamento. Quando executamos alguma a√ß√£o na Entidade Tema, a mesma a√ß√£o ser√° aplicada √† Entidade associada em Postagem. 

- **onDelete:** O "cascateamento" foi habilitado apenas na opera√ß√£o Delete, ou seja, apenas quando um Objeto da Classe Tema for apagado, todos os Objetos da Classe Postagem associados ao Tema tamb√©m ser√£o apagados. O Inverso n√£o √© verdadeiro.

Al√©m de habilitar no delete, √© poss√≠vel habilitar o cascade na atualiza√ß√£o de dados, atrav√©s da op√ß√£o **OnUpdate** e na inser√ß√£o de dados, atrav√©s da op√ß√£o **onCreate**. No projeto Blog Pessoal, **n√£o iremos habilitar estas duas op√ß√µes**.

**Linha 25:** Ser√° criado um Objeto da Classe Tema, que receber√° os dados do Tema associado ao Objeto da Classe Postagem. Este Objeto representa a Chave Estrangeira da Tabela **tb_postagens (temaid)**.

Veja abaixo o c√≥digo completo da **Classe Entidade Postagem**:

```typescript
import { IsNotEmpty } from "class-validator"
import { Column, Entity, ManyToOne, PrimaryGeneratedColumn, UpdateDateColumn } from "typeorm"
import { Tema } from "../../tema/entities/tema.entity"

@Entity({name: "tb_postagens"})
export class Postagem {

    @PrimaryGeneratedColumn()    
    id: number

    @IsNotEmpty()
    @Column({length: 100, nullable: false})
    titulo: string

    @IsNotEmpty()
    @Column({length: 1000, nullable: false})
    texto: string

    @UpdateDateColumn()
    data: Date
    
    @ManyToOne(() => Tema, (tema) => tema.postagem, {
        onDelete: "CASCADE"
    })
    tema: Tema

}
```

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar o Relacionamento entre as Classes. Observe que ap√≥s habilitar o Relacionamento entre Classes, novas importa√ß√µes de Classes ser√£o necess√°rias nas primeiras linhas da Classe Postagem.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/techniques/database#relations" target="_blank"><b>Documenta√ß√£o: <i>Relacionamento entre Classes</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/relations" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Relacionamentos</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/many-to-one-one-to-many-relations" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Relacionamentos One to Many e Many to One</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/blob/09_Recurso_Tema_Relacionamento/blogpessoal/src/postagem/entities/postagem.entity.ts" target="_blank"><b>C√≥digo fonte da Classe Postagem</b></a>
<br /></div>

<br />


<h2>üë£ Passo 02 - Criar a Rela√ß√£o OneToMany na Classe Tema</h2>

A Classe Tema ser√° o lado 1:N, ou seja, **Um Tema pode ter Muitas Postagens**. Para criar a Rela√ß√£o vamos inserir depois do √∫ltimo atributo da Classe Tema (descricao), o trecho de c√≥digo destacado em amarelo na figura abaixo:

<div align="left"><img src="https://i.imgur.com/FJPCqms.png?1" title="source: imgur.com" /></div>

**Linha 15:** O decorator **@OneToMany** indica que a Classe Tema ser√° o lado 1:N da rela√ß√£o e ter√° um **array de Objetos da Classe Postagem**, chamado **postagem**, para listar todas as postagens associadas a cada tema.

**Linha 16:** Ser√° criado um array de Objetos da Classe Postagem, que receber√° os dados das postagens associadas a cada Objeto da Classe Tema.

Veja abaixo o c√≥digo completo da **Classe Entidade Postagem**:

```typescript
import { IsNotEmpty } from "class-validator";
import { Column, Entity, OneToMany, PrimaryGeneratedColumn } from "typeorm";
import { Postagem } from "../../postagem/entities/postagem.entity";

@Entity({name: "tb_temas"})
export class Tema {

    @PrimaryGeneratedColumn()    
    id: number

    @IsNotEmpty()
    @Column({length: 255, nullable: false})
    descricao: string

    @OneToMany(() => Postagem, (postagem) => postagem.tema)
    postagem: Postagem[]
    
}
```

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar o Relacionamento entre as Classes. Observe que ap√≥s habilitar o Relacionamento entre Classes, novas importa√ß√µes de Classes ser√£o necess√°rias nas primeiras linhas da Classe Tema.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/techniques/database#relations" target="_blank"><b>Documenta√ß√£o: <i>Relacionamento entre Classes</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/relations" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Relacionamentos</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/many-to-one-one-to-many-relations" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Relacionamentos One to Many e Many to One</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/blob/09_Recurso_Tema_Relacionamento/blogpessoal/src/tema/entities/tema.entity.ts" target="_blank"><b>C√≥digo fonte da Classe Tema</b></a></div>

<br />

<h2>üë£ Passo 03 - Executar o projeto</h2>

1. Verifique se voc√™ est√° dentro da pasta do projeto, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/67GK3fX.png" title="source: imgur.com" /></div>

2. Digite o comando ***npm run start:dev***, para compilar e executar o nosso projeto **blogpessoal**, caso n√£o esteja em execu√ß√£o. 

```bash
npm run start:dev
```

3. Se tudo deu certo, o resultado ser√° semelhante ao da figura abaixo:

<div align="center"><img src="https://i.imgur.com/Fy3P1Wp.png" title="source: imgur.com" /></div>

4.Aparentemente n√£o mudou nada, mas vamos checar o Banco de dados...

<br />

<h2>üë£ Passo 04 - Checar o Banco de dados</h2>

1. Abra o **MySQL Workbench** 
1. Verifique se a **Chave Estrangeira (temaId)** foi criada na Tabela **tb_postagens**, no Banco de dados **db_blogpessoal**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/9snuJVa.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_nest/tree/09_Recurso_Tema_Relacionamento" target="_blank"><b>C√≥digo fonte do Projeto</b></a></div>

<br /><br />
	

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
